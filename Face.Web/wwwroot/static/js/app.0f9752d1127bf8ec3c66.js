webpackJsonp([1],{"GyO/":function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("7+uW"),i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[t._m(0),t._v(" "),a("ul",{staticClass:"nav nav-pills nav-fill mb-3",attrs:{id:"pills-tab",role:"tablist"}},[a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{"active-class":"active",to:"/register"}},[t._v("\n        注册\n    ")])],1),t._v(" "),a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{"active-class":"active",to:"/verify"}},[t._v("\n        识别\n      ")])],1),t._v(" "),a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{"active-class":"active",to:"/camera"}},[t._v("\n        相机\n      ")])],1)]),t._v(" "),a("hr"),t._v(" "),a("router-view")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app-title"},[e("p",[this._v("人脸识别")])])}]};var n=a("VU/8")({name:"App"},i,!1,function(t){a("ObJn")},null,null).exports,r=a("/ocq"),o={name:"pills-verify",data:function(){return{model:{image:null,group:"BOSCH",name:""},loading:"",resultStatus:"",resultDetails:"",resultName:"",resultGroup:"",resultScore:""}},methods:{upload:function(t){this.model.image=t[0],this.resultStatus="",this.resultName="",this.resultGroup="",this.resultScore="",this.showPreview(t[0])},showPreview:function(t){var e=new FileReader;e.onload=function(t){document.getElementById("face_preview2").src=t.target.result},e.readAsDataURL(t)},onSubmit:function(){var t=this,e=new FormData;e.append("Image",this.model.image),e.append("GroupId",this.model.group),this.loading="头像识别中，请稍等.",this.axios.post("http://10.172.10.145:8082/api/Face/Verify",e).then(function(e){t.loading="头像识别完成","success"==e.data.msg?(t.resultName="用户名："+e.data.data.result[0].user_id,t.resultScore="匹配度："+e.data.data.result[0].score):t.resultStatus="错误："+e.data.msg})}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("div",{staticClass:"tab-content",attrs:{id:"pills-tabContent"}},[a("div",{staticClass:"tab-pane fade show active",attrs:{id:"pills-verify",role:"tabpanel","aria-labelledby":"pills-verify-tab"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[a("form",{attrs:{enctype:"multipart/form-data"},on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("群组:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.model.group,expression:"model.group"}],staticClass:"form-control",attrs:{type:"text",required:"",placeholder:"BOSCH",name:"subject_name"},domProps:{value:t.model.group},on:{input:function(e){e.target.composing||t.$set(t.model,"group",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("上传需要识别的头像图片：")]),t._v(" "),a("input",{staticClass:"form-control",attrs:{type:"file",accept:"image/*",name:"image"},on:{change:function(e){return t.upload(e.target.files)}}})]),t._v(" "),a("div",{staticClass:"form-group"},[a("button",{staticClass:"btn btn-primary"},[t._v("识别")]),t._v(" "),a("span",{staticClass:"fa fa-spin fa-spinner",staticStyle:{display:"none"},attrs:{id:"verify_spinner","aria-hidden":"true"}}),t._v("\r\n                            "+t._s(t.loading)+"\r\n                        ")])])]),t._v(" "),a("div",{staticClass:"col-md-6"},[a("p",{staticStyle:{"text-align":"center"}},[t._v("图像预览")]),t._v(" "),a("div",{staticClass:"col-md-6",staticStyle:{"text-align":"center"}},[a("img",{staticClass:"img-responsive",attrs:{id:"face_preview2",alt:"",height:"200"}}),t._v(" "),a("p",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.resultStatus))]),t._v(" "),a("p",{staticStyle:{"text-align":"left"}},[t._v(t._s(t.resultName))]),t._v(" "),a("p",{staticStyle:{"text-align":"left"}},[t._v(t._s(t.resultScore))])])])])])])])},staticRenderFns:[]};var c=a("VU/8")(o,l,!1,function(t){a("fzx1")},"data-v-d689b6fe",null).exports,u=(a("+sNg"),a("OWGu"),a("hrgf"),a("zWIn"),{name:"testTracking",data:function(){return{model:{image:null,group:"BOSCH",name:""},video:{width:740,height:480},resultName:"",resultScore:"",resultStatus:"",loading:"",submitting:!1}},mounted:function(){this.openCamera()},methods:{stopTracking:function(){this.trackerTask.stop(),this.trackerTask.closeCamera()},dataURLtoFile:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file",a=arguments[2],s=t.split(","),i=atob(s[1]);!a&&(a=s[0].replace("data:","").replace(";base64",""));for(var n=i.length,r=new Uint8Array(n);n--;)r[n]=i.charCodeAt(n);return new File([r],e,{type:a})},openCamera:function(){navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}).then(function(t){document.getElementById("video").srcObject=t});var t=document.getElementById("canvas"),e=t.getContext("2d"),a=this,s=new tracking.ObjectTracker("face");s.setInitialScale(4),s.setStepSize(2),s.setEdgesDensity(.1),console.log("traker initialized"),this.trackerTask=tracking.track("#video",s,{camera:!0}),s.on("track",function(s){e.clearRect(0,0,t.width,t.height),s.data.forEach(function(t){e.font="11px Helvetica",e.strokeStyle="#a64ceb",e.strokeRect(t.x,t.y,t.width,t.height),a.submitting||"success"==a.resultStatus||(a.submitting=!0,a.submit())})})},submit:function(){var t=this,e=document.getElementById("canvas"),a=e.getContext("2d"),s=document.getElementById("video");a.drawImage(s,0,0,this.video.width,this.video.height),this.model.image=this.dataURLtoFile(e.toDataURL(),"image.png");var i=new FormData;i.append("Image",this.model.image),i.append("GroupId",this.model.group),this.axios.post("http://10.172.10.145:8082/api/Face/Verify",i).then(function(e){"success"==e.data.msg?(t.resultName=e.data.data.result[0].user_id,t.resultScore=e.data.data.result[0].score,t.resultStatus=e.data.msg):(t.resultScore="",t.resultName="",t.resultStatus=e.data.msg),t.submitting=!1})}},destroyed:function(){this.stopTracking()}}),d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"testTracking"},[a("video",{attrs:{id:"video",width:this.video.width,height:this.video.height,preload:"",autoplay:"",loop:"",muted:""},domProps:{muted:!0}}),t._v(" "),a("canvas",{attrs:{id:"canvas",width:this.video.width,height:this.video.height}}),t._v(" "),a("div",{staticClass:"buttonDiv"},[a("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.submit()}}},[t._v("点击识别")])]),t._v(" "),a("div",{staticClass:"resultDiv"},[a("p1",[t._v("用户名："+t._s(t.resultName))]),t._v(" "),a("p1",[t._v("匹配度："+t._s(t.resultScore))]),t._v(" "),a("p1",[t._v("识别状态："+t._s(t.resultStatus))])],1)])},staticRenderFns:[]};var m=a("VU/8")(u,d,!1,function(t){a("GyO/")},"data-v-ebc6f1d4",null).exports,p={name:"pills-upload",data:function(){return{model:{name:"小明",image:null,item:"",group:"BOSCH"},loading:"",uploadStatus:""}},methods:{upload:function(t){this.model.image=t[0],this.uploadStatus="",this.showPreview(t[0])},showPreview:function(t){var e=new FileReader;e.onload=function(t){document.getElementById("face_preview1").src=t.target.result},e.readAsDataURL(t)},onSubmit:function(){var t=this,e=new FormData;e.append("Image",this.model.image),e.append("UserId",this.model.name),e.append("GroupId",this.model.group),this.loading="上传头像中，请稍等.",this.axios.post("http://10.172.10.145:8082/api/Face/Upload",e).then(function(e){t.loading="头像上传完成！",t.uploadStatus=e.data.msg})}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("div",{staticClass:"tab-content",attrs:{id:"pills-tabContent"}},[a("div",{staticClass:"tab-pane fade show active",attrs:{id:"pills-upload",role:"tabpanel","aria-labelledby":"pills-upload-tab"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[a("form",{attrs:{enctype:"multipart/form-data"},on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("名字:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.model.name,expression:"model.name"}],staticClass:"form-control",attrs:{type:"text",required:"",placeholder:"小明",name:"subject_name"},domProps:{value:t.model.name},on:{input:function(e){e.target.composing||t.$set(t.model,"name",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("群组:")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.model.group,expression:"model.group"}],staticClass:"form-control",attrs:{type:"text",required:"",placeholder:"BOSCH",name:"subject_name"},domProps:{value:t.model.group},on:{input:function(e){e.target.composing||t.$set(t.model,"group",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("头像:")]),t._v(" "),a("input",{staticClass:"form-control",attrs:{type:"file",accept:"image/*",name:"image"},on:{change:function(e){return t.upload(e.target.files)}}})]),t._v(" "),a("div",{staticClass:"form-group"},[a("button",{staticClass:"btn btn-primary"},[t._v("上传")]),t._v("\r\n                            "+t._s(t.loading)+"\r\n                            "+t._s(t.uploadStatus)+"\r\n                        ")])])]),t._v(" "),a("div",{staticClass:"col-md-6"},[a("p",{staticStyle:{"text-align":"center"}},[t._v("图像预览")]),t._v(" "),a("div",{staticClass:"col-md-6",staticStyle:{"text-align":"center"}},[a("img",{staticClass:"img-responsive",attrs:{id:"face_preview1",alt:"",height:"200"}}),t._v(" "),a("p",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.model.name))])])])])])])])},staticRenderFns:[]};var g=a("VU/8")(p,v,!1,function(t){a("XZU8")},"data-v-e3bf9e8e",null).exports,f=a("VU/8")(null,null,!1,null,null,null).exports;s.a.use(r.a);var h=new r.a({routes:[{path:"/",name:"HelloWorld",component:f},{path:"/camera",name:"FaceCamera",component:m},{path:"/verify",name:"FaceVerify",component:c},{path:"/register",name:"FaceRegister",component:g}]}),_=(a("qb6w"),a("mtWM")),b=a.n(_),C=a("DWlv"),y=a.n(C);s.a.use(y.a,b.a),s.a.config.productionTip=!1,new s.a({el:"#app",router:h,components:{App:n},template:"<App/>"})},ObJn:function(t,e){},XZU8:function(t,e){},fzx1:function(t,e){},qb6w:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.0f9752d1127bf8ec3c66.js.map